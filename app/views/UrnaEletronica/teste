window.onload = function(){
	
	var host = "http://${request.host}";
	
	var carregarCandidados = function(candidatoNumero){
		var url = host + "/pegarCandidato/num="+candidatoNumero;
		$.getJSON(url, function(candidato){
			var numeros = candidato.numero; 
			console.log(quartos);
			if(numeros.length == 0){
				$("#select-quarto").html("<option> NÃO EXISTEM QUARTOS PARA A ALA SELECIONADA </option>");
				$("#select-leito").html("<option> NÃO EXISTEM LEITOS PARA O QUARTO SELECIONADO </option>");
			}else{
				$("#select-quarto").html("");
				$.each(quartos, function(i, quarto){
					if(i == 0){
						$("#select-quarto").append("<option value="+quarto.id+" selected>" + quarto.numeroQuarto +"</option>");
						carregarLeitos(quarto.id);
					}else{
						$("#select-quarto").append("<option value="+quarto.id+">" + quarto.numeroQuarto +"</option>");
					}
		        });
			}
		});
	};
	
	var carregarLeitos = function(idQuarto){
		var url = host + "/alas/leitosQuarto?idQuarto="+idQuarto;
		$.getJSON(url, function(leitos){	
			if(leitos.length == 0){
				$("#select-leito").html("<option> NÃO EXISTEM LEITOS PARA O QUARTO SELECIONADO </option>");
			}else{
				$("#select-leito").html("");
				$.each(leitos, function(i, leito){
		            $("#select-leito").append("<option value="+leito.id+">" + leito.numeroLeito +"</option>");
		        });
			}
		});
	};
	
	$("#select-ala").change(function() {
		var alaSelecionada = $(this).find(":selected");
		var alaID = alaSelecionada.val();
		console.log(alaID);
		if(alaID == ''){
			$("#select-quarto").html("<option> NÃO EXISTEM QUARTOS PARA A ALA SELECIONADA </option>");
			$("#select-leito").html("<option> NÃO EXISTEM LEITOS PARA O QUARTO SELECIONADO </option>");
		}else{
			carregarQuartos(alaID);	
		}	
	});
	
	$("#select-quarto").change(function() {
		var quartoSelecionado = $(this).find(":selected");
		var idQuarto = quartoSelecionado.val();
		carregarLeitos(idQuarto);
	});
	
	var selectMedico = $('#sel-medico').find(":selected");
	var nomeMedico = selectMedico.text();
	var idMedico = selectMedico.val();

	  
   
     $.notifyDefaults({
     	type: 'success',
     	allow_dismiss: true,
     });
     
     
     //
     
     
     $("#add-ala").click(function(){
     	
     	var medicoAdicionado = function(idMedico){
     		var inputHiddenMed = $("#al-"+idMedico);
     		console.log(inputHiddenMed);
     		console.log(inputHiddenMed.lenght);
     		return (inputHiddenMed.val());
     	};
     	
     	var selectMedico = $('#sel-al').find(":selected");
     	var nomeMedico = selectMedico.text();
     	var idMedico = selectMedico.val();
     	
     	var html = "<li id='li-al-" + idMedico + "' class='list-group-item d-flex justify-content-between align-items-center'> " +
 		    		  	"<input id='al-" + idMedico + "' type='hidden' name='alasIDs' value='" + idMedico + "'> " +
 		    		  		nomeMedico +
 		    		  		"<button type='button' class='del-al btn btn-danger btn-sm' value='" + idMedico + "'>" +
 		    		  		"<span class='glyphicon glyphicon-remove'></span> Remover " +
 		    		  		"</button>" +
 		    	   "</li>";
     	
 		console.log(idMedico);
 		console.log(medicoAdicionado(idMedico));
 		
 		if(!medicoAdicionado(idMedico)){
 			$("#alas").append(html);
 		}else{
 			$.notify('O medico <b>' + nomeMedico + '</b> jÃ¡ foi adicionado.');
 		}
         
         
         $(".del-al").click(function(){
         	var idMedico = $(this).attr("value");
         	$("#li-al-" + idMedico).remove();
         });
     });
     
     
     $(".del-al").click(function(){
     	var idMedico = $(this).attr("value");
     	$("#li-al-" + idMedico).remove();
     });
     
      $.notifyDefaults({
      	type: 'success',
      	allow_dismiss: true,
      });
    
    
};